"use strict";const formElement=document.querySelector(".js-form"),searchInput=document.querySelector(".js-search"),btnElement=document.querySelector(".js-btn"),showsResult=document.querySelector(".js-tvshows"),favElements=document.querySelector(".js-list-favorites");let series=[],favSeries=[];const getDataFromApi=()=>{const e=searchInput.value;fetch("//api.tvmaze.com/search/shows?q= + "+e).then(e=>e.json()).then(e=>{series=e,renderShows(),setInLocalStorage()})};function renderShows(){let e="";for(let s=0;s<series.length;s++){let t=series[s].show.image,r=series[s].show.id,a=series[s].show.name;isFav(series[s])?e+=`<li class="js__show tvshows tvshows__favorite" id="${r}">`:e+=`<li class="js__show tvshows" id="${r}">`,e+="<article>",e+=null===t?`<img class="tvshows__img"src="//via.placeholder.com/210x295/ffffff/666666/?text=TV" title="${a}" alt="${a} cover not available"/>`:`<img src="${t.medium}" alt="Show image" ${a}" class="tvshows__img"></img>`,e+=`<h5 class="tvshows__name">${a}</h5>`,e+="</article>",e+="</li>"}showsResult.innerHTML=e,listenFavs()}function handleForm(e){e.preventDefault()}function handleSearch(){getDataFromApi()}function isFav(e){return!!favSeries.find(s=>s.show.id===e.show.id)}formElement.addEventListener("submit",handleForm),btnElement.addEventListener("click",handleSearch);const selectedFavs=e=>{const s=parseInt(e.currentTarget.id);let t=series.find(e=>s===e.show.id),r=favSeries.findIndex(e=>s===e.show.id);-1===r?favSeries.push(t):favSeries.splice(r,1),renderFavs(),renderShows()};function listenFavs(){const e=document.querySelectorAll(".js__show");for(const s of e)s.addEventListener("click",handleFavs)}function renderFavs(){if(0===favSeries.length)return void(favElements.innerHTML="");let e="";for(let s=0;s<favSeries.length;s++){let t=favSeries[s].show.image,r=favSeries[s].show.id,a=favSeries[s].show.name;e+=`<li class="favSection js__show" id="${r}">`,e+="<article>",e+=null===t?`<img class="favSection__img"src="//via.placeholder.com/210x295/ffffff/666666/?text=TV" title="${a}" alt="${a} cover not available"/>`:`<img src="${t.medium}" alt="Show image" ${a}" class="favSection__img"></img>`,e+=`<h5 class="favSection__name">${a}</h5>`,e+='<button class="favSection__removebtn"><i class="far fa-trash-alt icon"></i></button>',e+="</article>",e+="</li >"}favElements.innerHTML=e,setInLocalStorage(),listenFavs()}function setInLocalStorage(){const e=JSON.stringify(favSeries);localStorage.setItem("favSeries",e)}function getFromLocalStorage(){const e=localStorage.getItem("favSeries");if(null===e)getDataFromApi();else{const s=JSON.parse(e);favSeries=s,renderFavs()}}getFromLocalStorage();const resetBtn=document.querySelector(".js-resetBtn"),resetFavorites=()=>{favSeries=[],localStorage.removeItem("favSeries"),renderFavs(),renderShows()};function handleFavs(e){selectedFavs(e),renderFavs(),renderShows()}resetBtn.addEventListener("click",resetFavorites);